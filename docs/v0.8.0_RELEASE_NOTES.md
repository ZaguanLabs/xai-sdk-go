# xAI SDK Go v0.8.0 Release Notes

**Release Date**: November 24, 2025

## üéØ Overview

Version 0.8.0 brings the xAI SDK for Go into full alignment with xAI's official API specifications by integrating protobuf definitions from the official `xai-proto` repository. This release significantly enhances type safety and correctness while maintaining complete backward compatibility for the public SDK API.

## ‚ú® What's New

### Official Proto Integration

This release integrates complete, official protobuf definitions directly from xAI's proto repository, ensuring the SDK is always in sync with the latest API specifications.

**Key Improvements:**
- ‚úÖ Enhanced type safety with proper optional field handling
- ‚úÖ Proper `oneof` discriminated unions for variant types
- ‚úÖ Complete gRPC service definitions with streaming support
- ‚úÖ Better structured nested messages and enums

### New Proto Files

Created complete service definitions for APIs that were previously inferred:

- **`files.proto`**: Complete Files API with streaming upload/download
- **`collections.proto`**: Complete Collections API with document management

### Enhanced Type Safety

**Optional Fields as Pointers:**
Many fields are now properly typed as pointers to distinguish between "not set" and "zero value":
- `ReasoningContent`: `string` ‚Üí `*string`
- `ErrorMessage` in `ToolCall`: `string` ‚Üí `*string`
- `MaxTokens`, `Temperature`, `TopP`: values ‚Üí pointers
- `Country`, `PostFavoriteCount`, `PostViewCount`: values ‚Üí pointers

**Oneof Discriminated Unions:**
Variant types now use proper `oneof` structures:
- `Content`: Text, ImageUrl, or File variants
- `ToolCall`: Function or other tool type variants
- `Tool`: WebSearch, XSearch, CodeExecution, etc.
- `EmbedInput`: Text or token array variants
- `Source`: Web, News, X, or RSS variants

## üîÑ Changes

### Proto Structure Changes

The underlying protobuf structures have been updated to match official specifications. **However, the public SDK API remains completely unchanged.**

#### Before (v0.7.0)
```go
// Direct field access
content := &xaiv1.Content{Text: "Hello"}
text := content.Text
```

#### After (v0.8.0)
```go
// Oneof wrapper + getter
content := &xaiv1.Content{
    Content: &xaiv1.Content_Text{Text: "Hello"},
}
text := content.GetText()
```

### Field Access Patterns

Oneof fields now require getter methods for safe access:
- `content.Text` ‚Üí `content.GetText()`
- `toolCall.Function` ‚Üí `toolCall.GetFunction()`
- `source.Web` ‚Üí `source.GetWeb()`

This provides automatic nil handling and better type safety.

## üöÄ For SDK Users

### No Migration Required!

**The public SDK API is completely unchanged.** All your existing code will continue to work without any modifications:

```go
// ‚úÖ This still works exactly the same
client := xai.NewClient(apiKey)
resp, err := client.Chat().CreateCompletion(ctx,
    chat.NewRequest("grok-beta").
        AddMessage(chat.User(chat.Text("Hello!"))),
)

// ‚úÖ Streaming still works the same
stream, err := client.Chat().CreateCompletionStream(ctx, req)
for chunk := range stream.Chunks() {
    fmt.Print(chunk.Delta())
}

// ‚úÖ Function calling still works the same
tool := chat.NewTool("get_weather", "Get weather").
    WithParameter("city", "string", "City name", true)
req := chat.NewRequest("grok-beta", chat.WithTool(tool))

// ‚úÖ All other APIs work the same
// Images, Files, Collections, Embeddings, etc.
```

### Who Is Affected?

Only users doing **advanced/internal operations** like:
- Directly constructing protobuf messages
- Directly accessing `.proto` fields
- Manual proto marshaling/unmarshaling

This is **rare** - most users interact through the SDK's builder pattern and methods.

## üîß For Advanced Users

If you directly access `.proto` fields, here's what changed:

### 1. Use Getter Methods for Oneof Fields

```go
// Before
text := msg.Content[0].Text

// After
text := msg.Content[0].GetText()
```

### 2. Handle Pointer Types

```go
// Before
msg.ReasoningContent = "thinking..."

// After
reasoning := "thinking..."
msg.ReasoningContent = &reasoning
```

### 3. Use Oneof Wrappers

```go
// Before
content := &xaiv1.Content{Text: "Hello"}

// After
content := &xaiv1.Content{
    Content: &xaiv1.Content_Text{Text: "Hello"},
}
```

### 4. Check for Nil

```go
// Before
if msg.ReasoningContent != "" { ... }

// After
if msg.ReasoningContent != nil && *msg.ReasoningContent != "" { ... }
```

## üìä Testing & Quality

- ‚úÖ **All 200+ tests passing** across entire codebase
- ‚úÖ **`go test ./...`**: PASS
- ‚úÖ **`go build ./...`**: Success
- ‚úÖ **`go vet ./...`**: Clean
- ‚úÖ **All examples** compile and run correctly

## üéÅ Benefits

### Better Type Safety
- Proper optional field handling prevents nil pointer errors
- Compile-time type checking for variant types
- Safer field access with automatic nil handling

### Official Alignment
- SDK now matches xAI's official API specifications exactly
- Future updates will be easier to integrate
- Better compatibility with other xAI SDKs

### Improved Maintainability
- Cleaner proto patterns throughout codebase
- Better structured messages and services
- Enhanced code documentation

## üì¶ Installation

```bash
go get github.com/ZaguanLabs/xai-sdk-go@v0.8.0
```

## üîó Resources

- **GitHub**: https://github.com/ZaguanLabs/xai-sdk-go
- **Documentation**: https://pkg.go.dev/github.com/ZaguanLabs/xai-sdk-go
- **Examples**: https://github.com/ZaguanLabs/xai-sdk-go/tree/main/examples
- **Changelog**: https://github.com/ZaguanLabs/xai-sdk-go/blob/main/CHANGELOG.md

## üí¨ Support

- **Issues**: https://github.com/ZaguanLabs/xai-sdk-go/issues
- **Discussions**: https://github.com/ZaguanLabs/xai-sdk-go/discussions

## üôè Acknowledgments

Special thanks to the xAI team for providing the official protobuf definitions and to all contributors who helped test and validate this release.

---

**Full Changelog**: https://github.com/ZaguanLabs/xai-sdk-go/compare/v0.7.0...v0.8.0
